function a0_0x1335(_0x7e1968,_0x1f3f4e){const _0x573a70=a0_0x573a();return a0_0x1335=function(_0x133554,_0x490f42){_0x133554=_0x133554-0x132;let _0x30dc4b=_0x573a70[_0x133554];return _0x30dc4b;},a0_0x1335(_0x7e1968,_0x1f3f4e);}const a0_0x4444d2=a0_0x1335;(function(_0x3f084b,_0x20ffaf){const _0x38ea6a=a0_0x1335,_0x3602fd=_0x3f084b();while(!![]){try{const _0x5e2325=-parseInt(_0x38ea6a(0x138))/0x1*(-parseInt(_0x38ea6a(0x179))/0x2)+parseInt(_0x38ea6a(0x13f))/0x3+-parseInt(_0x38ea6a(0x15d))/0x4*(-parseInt(_0x38ea6a(0x14c))/0x5)+-parseInt(_0x38ea6a(0x170))/0x6*(-parseInt(_0x38ea6a(0x176))/0x7)+-parseInt(_0x38ea6a(0x15b))/0x8+-parseInt(_0x38ea6a(0x140))/0x9+parseInt(_0x38ea6a(0x168))/0xa*(-parseInt(_0x38ea6a(0x167))/0xb);if(_0x5e2325===_0x20ffaf)break;else _0x3602fd['push'](_0x3602fd['shift']());}catch(_0x3df641){_0x3602fd['push'](_0x3602fd['shift']());}}}(a0_0x573a,0xc42b9));const a0_0x45b9e7=a0_0xe282;(function(_0x2592ae,_0x32448e){const _0x678b06=a0_0x1335,_0x5054af=a0_0xe282,_0x4130b4=_0x2592ae();while(!![]){try{const _0x500e9c=-parseInt(_0x5054af(0x1aa))/0x1*(-parseInt(_0x5054af(0x1ab))/0x2)+-parseInt(_0x5054af(0x1a6))/0x3+-parseInt(_0x5054af(0x19c))/0x4+-parseInt(_0x5054af(0x1ac))/0x5+-parseInt(_0x5054af(0x198))/0x6+-parseInt(_0x5054af(0x17a))/0x7*(-parseInt(_0x5054af(0x192))/0x8)+parseInt(_0x5054af(0x1a4))/0x9*(parseInt(_0x5054af(0x18a))/0xa);if(_0x500e9c===_0x32448e)break;else _0x4130b4[_0x678b06(0x16d)](_0x4130b4[_0x678b06(0x134)]());}catch(_0x573d88){_0x4130b4[_0x678b06(0x16d)](_0x4130b4['shift']());}}}(a0_0x1824,0xb222c));function a0_0xe282(_0x33591e,_0x38e671){const _0x1d0b03=a0_0x1824();return a0_0xe282=function(_0x43dc0c,_0x21e4d6){_0x43dc0c=_0x43dc0c-0x17a;let _0x5a9b2c=_0x1d0b03[_0x43dc0c];return _0x5a9b2c;},a0_0xe282(_0x33591e,_0x38e671);}const sqlite3=require(a0_0x45b9e7(0x180)),{open}=require('sqlite'),path=require(a0_0x45b9e7(0x186)),chalk=require(a0_0x45b9e7(0x19e));function a0_0x1824(){const _0xa9e9b5=a0_0x1335,_0x2dd103=['now','writeMessage','SQLite\x20store\x20initialized\x20successfully',_0xa9e9b5(0x13c),_0xa9e9b5(0x13a),_0xa9e9b5(0x173),'length',_0xa9e9b5(0x149),_0xa9e9b5(0x165),_0xa9e9b5(0x141),_0xa9e9b5(0x134),_0xa9e9b5(0x172),'parse','red',_0xa9e9b5(0x16f),_0xa9e9b5(0x177),_0xa9e9b5(0x16c),_0xa9e9b5(0x135),_0xa9e9b5(0x157),_0xa9e9b5(0x166),_0xa9e9b5(0x14a),_0xa9e9b5(0x15e),_0xa9e9b5(0x148),_0xa9e9b5(0x14e),_0xa9e9b5(0x159),_0xa9e9b5(0x13d),_0xa9e9b5(0x155),_0xa9e9b5(0x133),'chalk',_0xa9e9b5(0x16e),_0xa9e9b5(0x15c),_0xa9e9b5(0x150),_0xa9e9b5(0x154),_0xa9e9b5(0x137),_0xa9e9b5(0x164),_0xa9e9b5(0x16d),'3464586kIzrIG',_0xa9e9b5(0x146),_0xa9e9b5(0x132),'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20OR\x20REPLACE\x20INTO\x20messages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20(id,\x20remoteJid,\x20message,\x20timestamp,\x20pushName,\x20participant)\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?)',_0xa9e9b5(0x16a),_0xa9e9b5(0x171),_0xa9e9b5(0x144),_0xa9e9b5(0x142),'finalize',_0xa9e9b5(0x136),_0xa9e9b5(0x161),_0xa9e9b5(0x147),'prepare',_0xa9e9b5(0x143),_0xa9e9b5(0x160),_0xa9e9b5(0x15f),'initialize',_0xa9e9b5(0x174),_0xa9e9b5(0x151),_0xa9e9b5(0x156),_0xa9e9b5(0x15a),_0xa9e9b5(0x158),'Error\x20getting\x20chat\x20history:','messages.db','sqlite3',_0xa9e9b5(0x169)];return a0_0x1824=function(){return _0x2dd103;},a0_0x1824();}function a0_0x573a(){const _0xa23627=['2645469AiLlxI','11428893bWexUZ','PRAGMA\x20synchronous\x20=\x20NORMAL;','createSchema','join','4721945uBOkFN','unshift','bind','log','6185556GGfmtI','PRAGMA\x20journal_mode\x20=\x20WAL;','green','VACUUM','17795yzgJeL','message','error','Error\x20closing\x20database\x20connection:','addToQueue','1141HwkZdg','length','clearOldMessages','Cleanup\x20error','2285816CRUIrq','exports','queueProcessor','all','SELECT\x20message\x20FROM\x20messages\x20WHERE\x20remoteJid\x20=\x20?\x20ORDER\x20BY\x20timestamp\x20DESC\x20LIMIT\x20?','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_remoteJid\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20messages\x20(remoteJid)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','6907016VUTZsd','writeQueue','1244tNWIyM','run','floor','processQueue','DELETE\x20FROM\x20messages\x20WHERE\x20timestamp\x20<\x20?','getChatHistory','remoteJid','30761685BewJna','10ENllcY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20INDEX\x20IF\x20NOT\x20EXISTS\x20idx_remoteJid_timestamp\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20messages\x20(remoteJid,\x20timestamp\x20DESC)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','11zTwGjN','1921610VNgIWz','exec','3dwTojc','get','31608uBFZHO','push','Database','Error\x20loading\x20message:','590442hjUidC','246198TiEUsD','messages.upsert','changes','Error\x20processing\x20write\x20queue:','SELECT\x20message\x20FROM\x20messages\x20WHERE\x20remoteJid\x20=\x20?\x20AND\x20id\x20=\x20?','35ekGqro','COMMIT','ROLLBACK','26458SMOFIe','loadMessage','close','shift','logger','Database\x20connection\x20closed\x20successfully','isProcessingQueue','49wRYpwO','stringify','path','DatabaseManager','BEGIN\x20TRANSACTION','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20messages\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20remoteJid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20timestamp\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pushName\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20participant\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20messageType\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','red'];a0_0x573a=function(){return _0xa23627;};return a0_0x573a();}class DatabaseManager{static async[a0_0x45b9e7(0x1ad)](_0x2c5ff3){const _0x2d2438=a0_0x45b9e7;await _0x2c5ff3[_0x2d2438(0x181)](_0x2d2438(0x189)),await _0x2c5ff3[_0x2d2438(0x181)](_0x2d2438(0x18b)),await _0x2c5ff3[_0x2d2438(0x181)](_0x2d2438(0x19b)),await _0x2c5ff3[_0x2d2438(0x181)](_0x2d2438(0x17c)),await _0x2c5ff3[_0x2d2438(0x181)](_0x2d2438(0x195));}}class MessageQueueProcessor{constructor(_0x5c01a8){const _0x9545a4=a0_0x45b9e7;this['db']=_0x5c01a8,this[_0x9545a4(0x1a0)]=[],this[_0x9545a4(0x1a3)]=![];}async[a0_0x45b9e7(0x1b4)](){const _0x12a283=a0_0x1335,_0x17282f=a0_0x45b9e7;if(this[_0x17282f(0x1a3)]||this[_0x12a283(0x15c)][_0x12a283(0x152)]===0x0)return;this[_0x17282f(0x1a3)]=!![];try{await this['db'][_0x12a283(0x15e)](_0x17282f(0x185));const _0x21e8f7=await this['db'][_0x17282f(0x1b2)](_0x17282f(0x1a9));while(this[_0x17282f(0x1a0)][_0x17282f(0x188)]>0x0){const _0x43b0d2=this[_0x17282f(0x1a0)][_0x17282f(0x18c)](),{key:_0x36d5f7,messageTimestamp:_0x4cf7aa,pushName:_0x45fefa,participant:_0x48c4be}=_0x43b0d2;await _0x21e8f7[_0x12a283(0x15e)](_0x36d5f7['id'],_0x36d5f7[_0x12a283(0x163)],JSON[_0x12a283(0x139)](_0x43b0d2),_0x4cf7aa,_0x45fefa,_0x48c4be);}await _0x21e8f7[_0x17282f(0x1ae)](),await this['db'][_0x17282f(0x197)](_0x17282f(0x191));}catch(_0x21c382){console[_0x17282f(0x199)](chalk[_0x17282f(0x18f)](_0x17282f(0x1b7),_0x21c382)),await this['db'][_0x17282f(0x197)](_0x12a283(0x178)),this[_0x12a283(0x15c)][_0x12a283(0x145)](...this[_0x17282f(0x1a0)]);}finally{this[_0x17282f(0x1a3)]=![],setTimeout(()=>this[_0x17282f(0x1b4)](),0x64);}}[a0_0x45b9e7(0x1a1)](_0x14c106){const _0x17891f=a0_0x1335,_0x185233=a0_0x45b9e7;this[_0x185233(0x1a0)][_0x185233(0x1a5)](_0x14c106),!this[_0x185233(0x1a3)]&&this[_0x17891f(0x160)]();}}class SQLiteMessageStore{constructor(_0x4954be){const _0x1fdc5e=a0_0x45b9e7;this[_0x1fdc5e(0x193)]=_0x4954be,this['db']=null,this['queueProcessor']=null;}async[a0_0x45b9e7(0x1b6)](){const _0x111553=a0_0x1335,_0x1de4ef=a0_0x45b9e7;try{this['db']=await open({'filename':path[_0x1de4ef(0x1b3)](__dirname,'..',_0x1de4ef(0x17f)),'driver':sqlite3[_0x1de4ef(0x19f)]}),await DatabaseManager[_0x111553(0x142)](this['db']),this[_0x1de4ef(0x194)]=new MessageQueueProcessor(this['db']),console[_0x111553(0x147)](chalk[_0x1de4ef(0x196)](_0x1de4ef(0x184)));}catch(_0x4c8958){console[_0x111553(0x14e)](chalk[_0x111553(0x13e)]('Error\x20initializing\x20SQLite\x20store:',_0x4c8958));throw _0x4c8958;}}async[a0_0x45b9e7(0x183)](_0xf70196){const _0x5c50ca=a0_0x45b9e7;this[_0x5c50ca(0x194)][_0x5c50ca(0x1a1)](_0xf70196);}async[a0_0x45b9e7(0x1a8)](_0x1bad83,_0x4f91a7){const _0x5d26df=a0_0x1335,_0x126ea2=a0_0x45b9e7;try{const _0x5911e1=await this['db'][_0x5d26df(0x16b)](_0x5d26df(0x175),[_0x1bad83,_0x4f91a7]);return _0x5911e1?JSON[_0x126ea2(0x18e)](_0x5911e1[_0x5d26df(0x14d)]):undefined;}catch(_0x366792){return console[_0x126ea2(0x199)](chalk['red'](_0x126ea2(0x190),_0x366792)),undefined;}}async[a0_0x4444d2(0x162)](_0xef897d,_0x5bd68b=0x32){const _0x295aef=a0_0x4444d2,_0x3584d4=a0_0x45b9e7;try{return await this['db'][_0x3584d4(0x17d)](_0x3584d4(0x19a),[_0xef897d,_0x5bd68b]);}catch(_0x4689c8){return console[_0x295aef(0x14e)](chalk[_0x3584d4(0x18f)](_0x3584d4(0x17e),_0x4689c8)),[];}}async[a0_0x4444d2(0x153)](_0x49636f=0x1){const _0x234a58=a0_0x4444d2,_0x3cbf89=a0_0x45b9e7;try{const _0x4a305f=Math[_0x3cbf89(0x1b5)](Date[_0x3cbf89(0x182)]()/0x3e8)-_0x49636f*0x18*0x3c*0x3c,_0x238a4e=await this['db'][_0x3cbf89(0x197)](_0x3cbf89(0x1b0),[_0x4a305f]);_0x238a4e[_0x3cbf89(0x187)]>0x3e8&&await this['db'][_0x3cbf89(0x197)](_0x234a58(0x14b));}catch(_0x2beb33){console[_0x234a58(0x14e)](_0x3cbf89(0x1a2));}}async[a0_0x45b9e7(0x1a7)](_0x4ce800){const _0x58b4d1=a0_0x45b9e7;_0x4ce800['on'](_0x58b4d1(0x18d),async({messages:_0x46e7ec})=>{const _0x3d7b4f=_0x58b4d1;for(const _0xdfef1f of _0x46e7ec){await this[_0x3d7b4f(0x183)](_0xdfef1f);}});}async['close'](){const _0x5cd483=a0_0x4444d2,_0x36033a=a0_0x45b9e7;try{this['db']&&(await this['db'][_0x36033a(0x19d)](),console[_0x36033a(0x1b1)](chalk[_0x5cd483(0x14a)](_0x36033a(0x1af))));}catch(_0x285533){console[_0x36033a(0x199)](chalk[_0x36033a(0x18f)](_0x5cd483(0x14f),_0x285533));}}}module[a0_0x45b9e7(0x17b)]=SQLiteMessageStore,module[a0_0x45b9e7(0x17b)][a0_0x4444d2(0x13b)]=DatabaseManager;